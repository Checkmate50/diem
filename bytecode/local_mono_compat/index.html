<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A monomorphization processor for elimination of universal type quantifiers (`forall t1: type, t2: type, ..., :: P&lt;t1, t2, ...&gt;`) found in the expressions"><meta name="keywords" content="rust, rustlang, rust-lang, local_mono_compat"><title>bytecode::local_mono_compat - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../bytecode/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module local_mono_compat</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li></ul></div><div id="sidebar-vars" data-name="local_mono_compat" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">bytecode</a>::<wbr><a class="mod" href="#">local_mono_compat</a><button id="copy-path" onclick="copy_path(this)" title="copy path"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item import" title="Copy item import to clipboard"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/bytecode/local_mono_compat.rs.html#4-431" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A monomorphization processor for elimination of universal type quantifiers
(<code>forall t1: type, t2: type, ..., :: P&lt;t1, t2, ...&gt;</code>) found in the expressions</p>
<p>This mono processor is a <em>local monomorphization</em> processor, it specializes
a generic proposition with types found in the enclosing function only. This
complements the <em>global monomorphization</em> processor in <code>mono_analysis.rs</code>
which, if schedule to run after this local mono pass, instantiate axioms
(and currently existential type quantifiers also) with information obtained
in the whole <code>GlobalEnv</code>.</p>
<p>Local monomorphization can only be performed when two conditions hold:</p>
<ul>
<li>
<p>all generic proposition are in the form of top-level universal type
quantifiers, i.e., the proposition <code>P</code> must be in the form of
<code>forall t1: type, t2: type, ... : expr&lt;t1, t2, ...&gt;</code> and there is no
operation over <code>P</code> (e.g., <code>!P</code>, <code>P ==&gt; Q</code>, etc. are not allowed).</p>
</li>
<li>
<p>the global invariant instrumentation pass places a global invariant
<code>I</code> into all relevant instantiations of a function <code>F</code>. For example,
if <code>I&lt;T&gt;</code> talks about a memory <code>S&lt;T&gt;</code> that is also going to be touched
by <code>F&lt;T&gt;</code>, then <code>I&lt;T&gt;</code> must be instrumented in the generic version of
<code>F</code> as well as in every instantiation of <code>F</code> (e.g., <code>F&lt;bool&gt;</code>,
<code>F&lt;u64&gt;</code>, etc).</p>
</li>
</ul>
<p>If both conditions hold, we can run local monomorphization, i.e., assert
properties that are only relevant to the enclosing function only and
safely assume that the properties hold for all other types that are
not touched by the function.</p>
<p>TODO(mengxu) this is added to maintain backward compatibility while the
implementation and porting of generic invariants are in progress.</p>
</div></details><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.LocalMonoCompatProcessor.html" title="bytecode::local_mono_compat::LocalMonoCompatProcessor struct">LocalMonoCompatProcessor</a></td><td class="docblock-short"><p>This is the monomorphization processor that works on a function level.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="bytecode" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div><script src="../../main.js"></script></body></html>